stages:
  preprocess:
    python: stages.preprocess
    deps:
      raw: data/raw.csv
    outs:
      clean: data/clean.csv

  # Matrix with auto-naming: train@bert_swe, train@bert_human, train@gpt_swe, train@gpt_human
  train:
    python: stages.train
    matrix:
      model:
        bert:
          params:
            hidden_size: 768
        gpt:
          params:
            hidden_size: 1024
      dataset:
        - swe
        - human
    deps:
      clean: data/clean.csv
      config: configs/${model}.yaml
    outs:
      model: models/${model}_${dataset}.pkl
    metrics:
      metrics: metrics/${model}_${dataset}.json
    params:
      model_type: ${model}
      learning_rate: 0.001
